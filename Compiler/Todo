Error reporting:
Replace all returns of int for error reporting
check exception status instead
Replace all throw errors
Call setexception